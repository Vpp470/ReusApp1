{"dependencies":[{"name":"react-native-web/dist/exports/Platform","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"dV3bI3NOD8bfMzaIniMaFGy/nn8=","exportNames":["*"],"imports":1}},{"name":"@react-native-async-storage/async-storage","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":7,"column":0,"index":174},"end":{"line":7,"column":69,"index":243}}],"key":"0kSRlooyBOaYM9tlTtK91nq+uds=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function(g,r,_i,a,m,_e,d){\"use strict\";Object.defineProperty(_e,'__esModule',{value:!0}),_e.isWebPushSupported=s,_e.getNotificationPermission=c,_e.registerServiceWorker=u,_e.requestNotificationPermission=b,_e.subscribeToWebPush=h,_e.unsubscribeFromWebPush=async function(e){try{const t=await navigator.serviceWorker.ready,n=await t.pushManager.getSubscription();return n&&await n.unsubscribe(),await fetch(`${o}/web-push/unsubscribe`,{method:'DELETE',headers:{Authorization:e}}),await i.default.removeItem('web_push_subscribed'),console.log('[WebPush] Dessubscrit correctament'),!0}catch(e){return console.error('[WebPush] Error dessubscrivint:',e),!1}},_e.isSubscribedToWebPush=w,_e.initWebPushIfPermitted=async function(e){if(!s())return;if('granted'===c()){await w()||(console.log('[WebPush] Re-subscrivint usuari amb perm\\xeds existent...'),await h(e))}},r(d[0]);var e,t=r(d[1]),i=(e=t)&&e.__esModule?e:{default:e};const o='/api';function n(e){const t=(e+'='.repeat((4-e.length%4)%4)).replace(/-/g,'+').replace(/_/g,'/'),i=window.atob(t),o=new Uint8Array(i.length);for(let e=0;e<i.length;++e)o[e]=i.charCodeAt(e);return o}function s(){return'serviceWorker'in navigator&&'PushManager'in window&&'Notification'in window}function c(){return'Notification'in window?Notification.permission:null}async function u(){if(!('serviceWorker'in navigator))return console.log('[WebPush] Service Worker no suportat'),null;try{const e=await navigator.serviceWorker.register('/sw.js',{scope:'/'});return console.log('[WebPush] Service Worker registrat:',e.scope),e}catch(e){return console.error('[WebPush] Error registrant Service Worker:',e),null}}async function b(){if(!('Notification'in window))return'denied';const e=await Notification.requestPermission();return console.log('[WebPush] Perm\\xeds de notificacions:',e),e}async function l(){try{const e=await fetch(`${o}/web-push/vapid-public-key`);if(!e.ok)throw new Error('No s\\'ha pogut obtenir la clau VAPID');return(await e.json()).vapidPublicKey}catch(e){return console.error('[WebPush] Error obtenint clau VAPID:',e),null}}async function h(e){if(!s())return console.log('[WebPush] Web Push no suportat'),!1;try{const t=await u();if(!t)throw new Error('No s\\'ha pogut registrar el Service Worker');if('granted'!==await b())return console.log('[WebPush] Perm\\xeds de notificacions no concedit'),!1;const s=await l();if(!s)throw new Error('No s\\'ha pogut obtenir la clau VAPID');const c=await t.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:n(s)});console.log('[WebPush] Subscripci\\xf3 creada:',c.endpoint);const h=c.toJSON();if(!(await fetch(`${o}/web-push/subscribe`,{method:'POST',headers:{'Content-Type':'application/json',Authorization:e},body:JSON.stringify({endpoint:c.endpoint,keys:{p256dh:h.keys?.p256dh,auth:h.keys?.auth}})})).ok)throw new Error('Error guardant subscripci\\xf3 al servidor');return await i.default.setItem('web_push_subscribed','true'),console.log('[WebPush] \\u2705 Subscripci\\xf3 completada amb \\xe8xit'),!0}catch(e){return console.error('[WebPush] Error subscrivint:',e),!1}}async function w(){if(!('serviceWorker'in navigator))return!1;try{const e=await navigator.serviceWorker.ready;return null!==await e.pushManager.getSubscription()}catch(e){return!1}}});","lineCount":1,"map":[[1,93,32,0,"_e"],[1,96,32,0,"isWebPushSupported"],[1,117,45,0,"_e"],[1,120,45,0,"getNotificationPermission"],[1,148,53,0,"_e"],[1,151,53,0,"registerServiceWorker"],[1,175,75,0,"_e"],[1,178,75,0,"requestNotificationPermission"],[1,210,105,0,"_e"],[1,213,105,0,"subscribeToWebPush"],[1,234,175,0,"_e"],[1,237,175,0,"unsubscribeFromWebPush"],[1,260,175,7,"async"],[1,275,175,45,"authToken"],[1,278,178,2],[1,282,179,4],[1,288,179,10,"registration"],[1,296,179,31,"navigator"],[1,306,179,41,"serviceWorker"],[1,320,179,55,"ready"],[1,326,180,10,"subscription"],[1,334,180,31,"registration"],[1,336,180,44,"pushManager"],[1,348,180,56,"getSubscription"],[1,366,197,4],[1,373,182,8,"subscription"],[1,382,183,12,"subscription"],[1,384,183,25,"unsubscribe"],[1,404,187,10,"fetch"],[1,410,187,16],[1,413,187,19,"API_BASE"],[1,438,187,52],[1,439,188,6,"method"],[1,446,188,14],[1,455,189,6,"headers"],[1,463,189,15],[1,464,190,8,"Authorization"],[1,478,190,25,"authToken"],[1,489,194,10,"AsyncStorage"],[1,491,194,22,"default"],[1,499,194,23,"removeItem"],[1,510,194,34],[1,533,196,4,"console"],[1,541,196,12,"log"],[1,545,196,16],[1,584,197,11],[1,585,199,2],[1,586,199,4],[1,592,199,11,"error"],[1,595,201,4],[1,602,200,4,"console"],[1,610,200,12,"error"],[1,616,200,18],[1,650,200,53,"error"],[1,654,201,11],[1,655,202,2],[1,656,203,0],[1,658,208,0,"_e"],[1,661,208,0,"isSubscribedToWebPush"],[1,685,225,0,"_e"],[1,688,225,0,"initWebPushIfPermitted"],[1,711,225,7,"async"],[1,726,225,45,"authToken"],[1,729,226,2],[1,733,226,7,"isWebPushSupported"],[1,737,226,29],[1,744,229,2],[1,747,229,21],[1,759,228,21,"getNotificationPermission"],[1,763,229,32],[1,770,230,31,"isSubscribedToWebPush"],[1,776,232,6,"console"],[1,784,232,14,"log"],[1,788,232,18],[1,855,233,12,"subscribeToWebPush"],[1,857,233,31,"authToken"],[1,860,235,2],[1,861,236,0],[1,863,236,1,"r"],[1,865,236,1,"d"],[1,867,236,1],[1,871,7,0],[1,875],[1,877,7,0,"_reactNativeAsyncStorageAsyncStorage"],[1,879,7,0,"r"],[1,881,7,0,"d"],[1,883,7,0],[1,887,7,0,"AsyncStorage"],[1,890],[1,892,7,0,"_reactNativeAsyncStorageAsyncStorage"],[1,896],[1,923,9,0],[1,929,9,6,"API_BASE"],[1,931,9,17],[1,938,14,0],[1,947,14,9,"urlBase64ToUint8Array"],[1,949,14,31,"base64String"],[1,952,15,2],[1,958,16,8,"base64"],[1,961,16,18,"base64String"],[1,963,15,18],[1,967,15,22,"repeat"],[1,975,15,30],[1,977,15,34,"base64String"],[1,979,15,47,"length"],[1,986,15,56],[1,989,15,61],[1,993,17,5,"replace"],[1,1001,17,13],[1,1006,17,19],[1,1011,18,5,"replace"],[1,1019,18,13],[1,1024,18,19],[1,1029,20,8,"rawData"],[1,1031,20,18,"window"],[1,1038,20,25,"atob"],[1,1043,20,30,"base64"],[1,1046,21,8,"outputArray"],[1,1048,21,22],[1,1052,21,26,"Uint8Array"],[1,1063,21,37,"rawData"],[1,1065,21,45,"length"],[1,1073,23,2],[1,1077,23,7],[1,1081,23,11,"i"],[1,1083,23,15],[1,1085,23,18,"i"],[1,1087,23,22,"rawData"],[1,1089,23,30,"length"],[1,1098,23,40,"i"],[1,1100,24,4,"outputArray"],[1,1102,24,16,"i"],[1,1105,24,21,"rawData"],[1,1107,24,29,"charCodeAt"],[1,1118,24,40,"i"],[1,1121,26,2],[1,1128,26,9,"outputArray"],[1,1129,27,0],[1,1130,32,7],[1,1139,32,16,"isWebPushSupported"],[1,1143,35,2],[1,1149,36,4],[1,1167,36,23,"navigator"],[1,1178,37,4],[1,1194,37,21,"window"],[1,1202,38,4],[1,1219,38,22,"window"],[1,1225,40,0],[1,1226,45,7],[1,1235,45,16,"getNotificationPermission"],[1,1239,46,2],[1,1245,46,33],[1,1262,46,51,"window"],[1,1269,47,9,"Notification"],[1,1282,47,22,"permission"],[1,1293,46,67],[1,1297,48,0],[1,1298,53,7,"async"],[1,1313,53,22,"registerServiceWorker"],[1,1317,54,2],[1,1322,54,33],[1,1340,54,52,"navigator"],[1,1351,56,4],[1,1358,55,4,"console"],[1,1366,55,12,"log"],[1,1370,55,16],[1,1410,56,11],[1,1415,59,2],[1,1419,60,4],[1,1425,60,10,"registration"],[1,1433,60,31,"navigator"],[1,1443,60,41,"serviceWorker"],[1,1457,60,55,"register"],[1,1466,60,64],[1,1475,60,74],[1,1476,61,6,"scope"],[1,1482,61,13],[1,1488,65,4],[1,1495,64,4,"console"],[1,1503,64,12,"log"],[1,1507,64,16],[1,1545,64,55,"registration"],[1,1547,64,68,"scope"],[1,1554,65,11,"registration"],[1,1555,66,2],[1,1556,66,4],[1,1562,66,11,"error"],[1,1565,68,4],[1,1572,67,4,"console"],[1,1580,67,12,"error"],[1,1586,67,18],[1,1631,67,64,"error"],[1,1634,68,11],[1,1638,69,2],[1,1639,70,0],[1,1640,75,7,"async"],[1,1655,75,22,"requestNotificationPermission"],[1,1659,76,2],[1,1664,76,33],[1,1681,76,51,"window"],[1,1689,77,4],[1,1695,77,11],[1,1704,80,2],[1,1710,80,8,"permission"],[1,1718,80,27,"Notification"],[1,1731,80,40,"requestPermission"],[1,1751,82,2],[1,1758,81,2,"console"],[1,1766,81,10,"log"],[1,1770,81,14],[1,1810,81,52,"permission"],[1,1813,82,9,"permission"],[1,1814,83,0],[1,1815,88,0,"async"],[1,1830,88,15,"getVapidPublicKey"],[1,1834,89,2],[1,1838,90,4],[1,1844,90,10,"response"],[1,1852,90,27,"fetch"],[1,1858,90,33],[1,1861,90,36,"API_BASE"],[1,1892,91,4],[1,1896,91,9,"response"],[1,1898,91,18,"ok"],[1,1901,92,6],[1,1907,92,12],[1,1911,92,16,"Error"],[1,1917,92,22],[1,1957,95,4],[1,1970,94,23,"response"],[1,1972,94,32,"json"],[1,1980,95,16,"vapidPublicKey"],[1,1994,96,2],[1,1995,96,4],[1,2001,96,11,"error"],[1,2004,98,4],[1,2011,97,4,"console"],[1,2019,97,12,"error"],[1,2025,97,18],[1,2064,97,58,"error"],[1,2067,98,11],[1,2071,99,2],[1,2072,100,0],[1,2073,105,7,"async"],[1,2088,105,22,"subscribeToWebPush"],[1,2090,105,41,"authToken"],[1,2093,106,2],[1,2097,106,7,"isWebPushSupported"],[1,2101,108,4],[1,2108,107,4,"console"],[1,2116,107,12,"log"],[1,2120,107,16],[1,2155,108,11],[1,2157,111,2],[1,2161,113,4],[1,2167,113,10,"registration"],[1,2175,113,31,"registerServiceWorker"],[1,2179,114,4],[1,2183,114,9,"registration"],[1,2185,115,6],[1,2191,115,12],[1,2195,115,16,"Error"],[1,2201,115,22],[1,2247,120,4],[1,2250,120,23],[1,2268,119,29,"requestNotificationPermission"],[1,2272,122,6],[1,2279,121,6,"console"],[1,2287,121,14,"log"],[1,2291,121,18],[1,2344,122,13],[1,2346,126,4],[1,2352,126,10,"vapidPublicKey"],[1,2360,126,33,"getVapidPublicKey"],[1,2364,127,4],[1,2368,127,9,"vapidPublicKey"],[1,2370,128,6],[1,2376,128,12],[1,2380,128,16,"Error"],[1,2386,128,22],[1,2426,132,4],[1,2432,132,10,"subscription"],[1,2440,132,31,"registration"],[1,2442,132,44,"pushManager"],[1,2454,132,56,"subscribe"],[1,2464,132,66],[1,2465,133,6,"userVisibleOnly"],[1,2482,133,23],[1,2484,134,6,"applicationServerKey"],[1,2505,134,28,"urlBase64ToUint8Array"],[1,2507,134,50,"vapidPublicKey"],[1,2512,137,4,"console"],[1,2520,137,12,"log"],[1,2524,137,16],[1,2559,137,49,"subscription"],[1,2561,137,62,"endpoint"],[1,2571,140,4],[1,2577,140,10,"subscriptionJson"],[1,2579,140,29,"subscription"],[1,2581,140,42,"toJSON"],[1,2590,156,4],[1,2601,141,27,"fetch"],[1,2607,141,33],[1,2610,141,36,"API_BASE"],[1,2633,141,67],[1,2634,142,6,"method"],[1,2641,142,14],[1,2648,143,6,"headers"],[1,2656,143,15],[1,2657,144,8],[1,2672,144,24],[1,2691,145,8,"Authorization"],[1,2705,145,25,"authToken"],[1,2708,147,6,"body"],[1,2713,147,12,"JSON"],[1,2718,147,17,"stringify"],[1,2728,147,27],[1,2729,148,8,"endpoint"],[1,2738,148,18,"subscription"],[1,2740,148,31,"endpoint"],[1,2749,149,8,"keys"],[1,2754,149,14],[1,2755,150,10,"p256dh"],[1,2762,150,18,"subscriptionJson"],[1,2764,150,35,"keys"],[1,2770,150,41,"p256dh"],[1,2777,151,10,"auth"],[1,2782,151,16,"subscriptionJson"],[1,2784,151,33,"keys"],[1,2790,151,39,"auth"],[1,2801,156,18,"ok"],[1,2804,157,6],[1,2810,157,12],[1,2814,157,16,"Error"],[1,2820,157,22],[1,2865,164,4],[1,2878,161,10,"AsyncStorage"],[1,2880,161,22,"default"],[1,2888,161,23,"setItem"],[1,2896,161,31],[1,2918,161,54],[1,2926,163,4,"console"],[1,2934,163,12,"log"],[1,2938,163,16],[1,2997,164,11],[1,2998,166,2],[1,2999,166,4],[1,3005,166,11,"error"],[1,3008,168,4],[1,3015,167,4,"console"],[1,3023,167,12,"error"],[1,3029,167,18],[1,3060,167,50,"error"],[1,3064,168,11],[1,3065,169,2],[1,3066,170,0],[1,3067,208,7,"async"],[1,3082,208,22,"isSubscribedToWebPush"],[1,3086,209,2],[1,3091,209,33],[1,3109,209,52,"navigator"],[1,3120,210,4],[1,3127,210,11],[1,3129,213,2],[1,3133,214,4],[1,3139,214,10,"registration"],[1,3147,214,31,"navigator"],[1,3157,214,41,"serviceWorker"],[1,3171,214,55,"ready"],[1,3177,216,4],[1,3184,216,28],[1,3197,215,31,"registration"],[1,3199,215,44,"pushManager"],[1,3211,215,56,"getSubscription"],[1,3228,217,2],[1,3229,217,4],[1,3235,217,11,"error"],[1,3238,218,4],[1,3245,218,11],[1,3246,219,2],[1,3247,220,0],[1,3248,236,1],[1,3251]],"functionMap":{"names":["<global>","urlBase64ToUint8Array","isWebPushSupported","getNotificationPermission","registerServiceWorker","requestNotificationPermission","getVapidPublicKey","subscribeToWebPush","unsubscribeFromWebPush","isSubscribedToWebPush","initWebPushIfPermitted"],"mappings":"AAA;ACa;CDa;OEK;CFQ;OGK;CHG;OIK;CJiB;OKK;CLQ;AMK;CNY;OOK;CPiE;OQK;CR4B;OSK;CTY;OUK;CVW"},"hasCjsExports":false},"type":"js/module"}]}