{"dependencies":[{"name":"react-native-web/dist/exports/Platform","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"dV3bI3NOD8bfMzaIniMaFGy/nn8=","exportNames":["*"],"imports":1}},{"name":"@react-native-async-storage/async-storage","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":7,"column":0,"index":174},"end":{"line":7,"column":69,"index":243}}],"key":"0kSRlooyBOaYM9tlTtK91nq+uds=","exportNames":["*"],"imports":1}},{"name":"expo-constants","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":8,"column":0,"index":244},"end":{"line":8,"column":39,"index":283}}],"key":"pPv5KzfRT0rL6NCr7G9k0o4d1W8=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function(g,r,_i,a,m,_e,d){\"use strict\";function e(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(_e,'__esModule',{value:!0}),_e.isWebPushSupported=s,_e.getNotificationPermission=c,_e.registerServiceWorker=u,_e.requestNotificationPermission=b,_e.getVapidPublicKey=l,_e.subscribeToWebPush=h,_e.unsubscribeFromWebPush=async function(e){try{const i=await navigator.serviceWorker.ready,n=await i.pushManager.getSubscription();n&&await n.unsubscribe();const s=o();return await fetch(`${s}/web-push/unsubscribe`,{method:'DELETE',headers:{Authorization:e}}),await t.default.removeItem('web_push_subscribed'),console.log('[WebPush] Dessubscrit correctament'),!0}catch(e){return console.error('[WebPush] Error dessubscrivint:',e),!1}},_e.isSubscribedToWebPush=p,_e.initWebPushIfPermitted=async function(e){if(!s())return;if('granted'===c()){await p()||(console.log('[WebPush] Re-subscrivint usuari amb perm\\xeds existent...'),await h(e))}},r(d[0]);var t=e(r(d[1])),i=e(r(d[2]));const o=()=>{const e=i.default.expoConfig?.extra?.EXPO_PUBLIC_BACKEND_URL||\"https://www.reusapp.com\";return e?`${e}/api`:'/api'};function n(e){const t=(e+'='.repeat((4-e.length%4)%4)).replace(/-/g,'+').replace(/_/g,'/'),i=window.atob(t),o=new Uint8Array(i.length);for(let e=0;e<i.length;++e)o[e]=i.charCodeAt(e);return o}function s(){return'serviceWorker'in navigator&&'PushManager'in window&&'Notification'in window}function c(){return'Notification'in window?Notification.permission:null}async function u(){if(!('serviceWorker'in navigator))return console.log('[WebPush] Service Worker no suportat'),null;try{const e=await navigator.serviceWorker.register('/sw.js',{scope:'/'});return console.log('[WebPush] Service Worker registrat:',e.scope),e}catch(e){return console.error('[WebPush] Error registrant Service Worker:',e),null}}async function b(){if(!('Notification'in window))return'denied';const e=await Notification.requestPermission();return console.log('[WebPush] Perm\\xeds de notificacions:',e),e}async function l(){try{const e=o();console.log('[WebPush] Obtenint clau VAPID de:',`${e}/web-push/vapid-public-key`);const t=await fetch(`${e}/web-push/vapid-public-key`);if(!t.ok)throw new Error('No s\\'ha pogut obtenir la clau VAPID');return(await t.json()).vapidPublicKey}catch(e){return console.error('[WebPush] Error obtenint clau VAPID:',e),null}}async function h(e){if(!s())return console.log('[WebPush] Web Push no suportat'),!1;try{const i=await u();if(!i)throw new Error('No s\\'ha pogut registrar el Service Worker');if('granted'!==await b())return console.log('[WebPush] Perm\\xeds de notificacions no concedit'),!1;const s=await l();if(!s)throw new Error('No s\\'ha pogut obtenir la clau VAPID');const c=await i.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:n(s)});console.log('[WebPush] Subscripci\\xf3 creada:',c.endpoint);const h=c.toJSON(),p=o();if(!(await fetch(`${p}/web-push/subscribe`,{method:'POST',headers:{'Content-Type':'application/json',Authorization:e},body:JSON.stringify({endpoint:c.endpoint,keys:{p256dh:h.keys?.p256dh,auth:h.keys?.auth}})})).ok)throw new Error('Error guardant subscripci\\xf3 al servidor');return await t.default.setItem('web_push_subscribed','true'),console.log('[WebPush] \\u2705 Subscripci\\xf3 completada amb \\xe8xit'),!0}catch(e){return console.error('[WebPush] Error subscrivint:',e),!1}}async function p(){if(!('serviceWorker'in navigator))return!1;try{const e=await navigator.serviceWorker.ready;return null!==await e.pushManager.getSubscription()}catch(e){return!1}}});","lineCount":1,"map":[[1,144,45,0,"_e"],[1,147,45,0,"isWebPushSupported"],[1,168,58,0,"_e"],[1,171,58,0,"getNotificationPermission"],[1,199,66,0,"_e"],[1,202,66,0,"registerServiceWorker"],[1,226,88,0,"_e"],[1,229,88,0,"requestNotificationPermission"],[1,261,101,0,"_e"],[1,264,101,0,"getVapidPublicKey"],[1,284,120,0,"_e"],[1,287,120,0,"subscribeToWebPush"],[1,308,191,0,"_e"],[1,311,191,0,"unsubscribeFromWebPush"],[1,334,191,7,"async"],[1,349,191,45,"authToken"],[1,352,194,2],[1,356,195,4],[1,362,195,10,"registration"],[1,370,195,31,"navigator"],[1,380,195,41,"serviceWorker"],[1,394,195,55,"ready"],[1,400,196,10,"subscription"],[1,408,196,31,"registration"],[1,410,196,44,"pushManager"],[1,422,196,56,"getSubscription"],[1,440,198,8,"subscription"],[1,449,199,12,"subscription"],[1,451,199,25,"unsubscribe"],[1,465,203,4],[1,471,203,10,"apiBase"],[1,473,203,20,"getApiBase"],[1,477,214,4],[1,490,204,10,"fetch"],[1,496,204,16],[1,499,204,19,"apiBase"],[1,524,204,51],[1,525,205,6,"method"],[1,532,205,14],[1,541,206,6,"headers"],[1,549,206,15],[1,550,207,8,"Authorization"],[1,564,207,25,"authToken"],[1,575,211,10,"AsyncStorage"],[1,577,211,22,"default"],[1,585,211,23,"removeItem"],[1,596,211,34],[1,619,213,4,"console"],[1,627,213,12,"log"],[1,631,213,16],[1,670,214,11],[1,671,216,2],[1,672,216,4],[1,678,216,11,"error"],[1,681,218,4],[1,688,217,4,"console"],[1,696,217,12,"error"],[1,702,217,18],[1,736,217,53,"error"],[1,740,218,11],[1,741,219,2],[1,742,220,0],[1,744,225,0,"_e"],[1,747,225,0,"isSubscribedToWebPush"],[1,771,242,0,"_e"],[1,774,242,0,"initWebPushIfPermitted"],[1,797,242,7,"async"],[1,812,242,45,"authToken"],[1,815,243,2],[1,819,243,7,"isWebPushSupported"],[1,823,243,29],[1,830,246,2],[1,833,246,21],[1,845,245,21,"getNotificationPermission"],[1,849,246,32],[1,856,247,31,"isSubscribedToWebPush"],[1,862,249,6,"console"],[1,870,249,14,"log"],[1,874,249,18],[1,941,250,12,"subscribeToWebPush"],[1,943,250,31,"authToken"],[1,946,252,2],[1,947,253,0],[1,949,253,1,"r"],[1,951,253,1,"d"],[1,953,253,1],[1,957,7,0],[1,961,7,0,"AsyncStorage"],[1,963,7,0,"_interopDefault"],[1,965,7,0,"r"],[1,967,7,0,"d"],[1,969,7,0],[1,974,8,0,"Constants"],[1,976,8,0,"_interopDefault"],[1,978,8,0,"r"],[1,980,8,0,"d"],[1,982,8,0],[1,987,11,0],[1,993,11,6,"getApiBase"],[1,995,11,19,"getApiBase"],[1,1000,13,2],[1,1006,13,8,"envUrl"],[1,1008,13,17,"Constants"],[1,1010,13,26,"default"],[1,1018,13,27,"expoConfig"],[1,1030,13,39,"extra"],[1,1037,13,46,"EXPO_PUBLIC_BACKEND_URL"],[1,1062,13,69],[1,1088,16,2],[1,1095,16,6,"envUrl"],[1,1097,17,11],[1,1100,17,14,"envUrl"],[1,1108,21,9],[1,1116,27,0],[1,1125,27,9,"urlBase64ToUint8Array"],[1,1127,27,31,"base64String"],[1,1130,28,2],[1,1136,29,8,"base64"],[1,1139,29,18,"base64String"],[1,1141,28,18],[1,1145,28,22,"repeat"],[1,1153,28,30],[1,1155,28,34,"base64String"],[1,1157,28,47,"length"],[1,1164,28,56],[1,1167,28,61],[1,1171,30,5,"replace"],[1,1179,30,13],[1,1184,30,19],[1,1189,31,5,"replace"],[1,1197,31,13],[1,1202,31,19],[1,1207,33,8,"rawData"],[1,1209,33,18,"window"],[1,1216,33,25,"atob"],[1,1221,33,30,"base64"],[1,1224,34,8,"outputArray"],[1,1226,34,22],[1,1230,34,26,"Uint8Array"],[1,1241,34,37,"rawData"],[1,1243,34,45,"length"],[1,1251,36,2],[1,1255,36,7],[1,1259,36,11,"i"],[1,1261,36,15],[1,1263,36,18,"i"],[1,1265,36,22,"rawData"],[1,1267,36,30,"length"],[1,1276,36,40,"i"],[1,1278,37,4,"outputArray"],[1,1280,37,16,"i"],[1,1283,37,21,"rawData"],[1,1285,37,29,"charCodeAt"],[1,1296,37,40,"i"],[1,1299,39,2],[1,1306,39,9,"outputArray"],[1,1307,40,0],[1,1308,45,7],[1,1317,45,16,"isWebPushSupported"],[1,1321,48,2],[1,1327,49,4],[1,1345,49,23,"navigator"],[1,1356,50,4],[1,1372,50,21,"window"],[1,1380,51,4],[1,1397,51,22,"window"],[1,1403,53,0],[1,1404,58,7],[1,1413,58,16,"getNotificationPermission"],[1,1417,59,2],[1,1423,59,33],[1,1440,59,51,"window"],[1,1447,60,9,"Notification"],[1,1460,60,22,"permission"],[1,1471,59,67],[1,1475,61,0],[1,1476,66,7,"async"],[1,1491,66,22,"registerServiceWorker"],[1,1495,67,2],[1,1500,67,33],[1,1518,67,52,"navigator"],[1,1529,69,4],[1,1536,68,4,"console"],[1,1544,68,12,"log"],[1,1548,68,16],[1,1588,69,11],[1,1593,72,2],[1,1597,73,4],[1,1603,73,10,"registration"],[1,1611,73,31,"navigator"],[1,1621,73,41,"serviceWorker"],[1,1635,73,55,"register"],[1,1644,73,64],[1,1653,73,74],[1,1654,74,6,"scope"],[1,1660,74,13],[1,1666,78,4],[1,1673,77,4,"console"],[1,1681,77,12,"log"],[1,1685,77,16],[1,1723,77,55,"registration"],[1,1725,77,68,"scope"],[1,1732,78,11,"registration"],[1,1733,79,2],[1,1734,79,4],[1,1740,79,11,"error"],[1,1743,81,4],[1,1750,80,4,"console"],[1,1758,80,12,"error"],[1,1764,80,18],[1,1809,80,64,"error"],[1,1812,81,11],[1,1816,82,2],[1,1817,83,0],[1,1818,88,7,"async"],[1,1833,88,22,"requestNotificationPermission"],[1,1837,89,2],[1,1842,89,33],[1,1859,89,51,"window"],[1,1867,90,4],[1,1873,90,11],[1,1882,93,2],[1,1888,93,8,"permission"],[1,1896,93,27,"Notification"],[1,1909,93,40,"requestPermission"],[1,1929,95,2],[1,1936,94,2,"console"],[1,1944,94,10,"log"],[1,1948,94,14],[1,1988,94,52,"permission"],[1,1991,95,9,"permission"],[1,1992,96,0],[1,1993,101,7,"async"],[1,2008,101,22,"getVapidPublicKey"],[1,2012,102,2],[1,2016,103,4],[1,2022,103,10,"apiBase"],[1,2024,103,20,"getApiBase"],[1,2028,104,4,"console"],[1,2036,104,12,"log"],[1,2040,104,16],[1,2076,104,53],[1,2079,104,56,"apiBase"],[1,2110,105,4],[1,2116,105,10,"response"],[1,2124,105,27,"fetch"],[1,2130,105,33],[1,2133,105,36,"apiBase"],[1,2164,106,4],[1,2168,106,9,"response"],[1,2170,106,18,"ok"],[1,2173,107,6],[1,2179,107,12],[1,2183,107,16,"Error"],[1,2189,107,22],[1,2229,110,4],[1,2242,109,23,"response"],[1,2244,109,32,"json"],[1,2252,110,16,"vapidPublicKey"],[1,2266,111,2],[1,2267,111,4],[1,2273,111,11,"error"],[1,2276,113,4],[1,2283,112,4,"console"],[1,2291,112,12,"error"],[1,2297,112,18],[1,2336,112,58,"error"],[1,2339,113,11],[1,2343,114,2],[1,2344,115,0],[1,2345,120,7,"async"],[1,2360,120,22,"subscribeToWebPush"],[1,2362,120,41,"authToken"],[1,2365,121,2],[1,2369,121,7,"isWebPushSupported"],[1,2373,123,4],[1,2380,122,4,"console"],[1,2388,122,12,"log"],[1,2392,122,16],[1,2427,123,11],[1,2429,126,2],[1,2433,128,4],[1,2439,128,10,"registration"],[1,2447,128,31,"registerServiceWorker"],[1,2451,129,4],[1,2455,129,9,"registration"],[1,2457,130,6],[1,2463,130,12],[1,2467,130,16,"Error"],[1,2473,130,22],[1,2519,135,4],[1,2522,135,23],[1,2540,134,29,"requestNotificationPermission"],[1,2544,137,6],[1,2551,136,6,"console"],[1,2559,136,14,"log"],[1,2563,136,18],[1,2616,137,13],[1,2618,141,4],[1,2624,141,10,"vapidPublicKey"],[1,2632,141,33,"getVapidPublicKey"],[1,2636,142,4],[1,2640,142,9,"vapidPublicKey"],[1,2642,143,6],[1,2648,143,12],[1,2652,143,16,"Error"],[1,2658,143,22],[1,2698,147,4],[1,2704,147,10,"subscription"],[1,2712,147,31,"registration"],[1,2714,147,44,"pushManager"],[1,2726,147,56,"subscribe"],[1,2736,147,66],[1,2737,148,6,"userVisibleOnly"],[1,2754,148,23],[1,2756,149,6,"applicationServerKey"],[1,2777,149,28,"urlBase64ToUint8Array"],[1,2779,149,50,"vapidPublicKey"],[1,2784,152,4,"console"],[1,2792,152,12,"log"],[1,2796,152,16],[1,2831,152,49,"subscription"],[1,2833,152,62,"endpoint"],[1,2843,155,4],[1,2849,155,10,"subscriptionJson"],[1,2851,155,29,"subscription"],[1,2853,155,42,"toJSON"],[1,2862,156,10,"apiBase"],[1,2864,156,20,"getApiBase"],[1,2868,172,4],[1,2879,157,27,"fetch"],[1,2885,157,33],[1,2888,157,36,"apiBase"],[1,2911,157,66],[1,2912,158,6,"method"],[1,2919,158,14],[1,2926,159,6,"headers"],[1,2934,159,15],[1,2935,160,8],[1,2950,160,24],[1,2969,161,8,"Authorization"],[1,2983,161,25,"authToken"],[1,2986,163,6,"body"],[1,2991,163,12,"JSON"],[1,2996,163,17,"stringify"],[1,3006,163,27],[1,3007,164,8,"endpoint"],[1,3016,164,18,"subscription"],[1,3018,164,31,"endpoint"],[1,3027,165,8,"keys"],[1,3032,165,14],[1,3033,166,10,"p256dh"],[1,3040,166,18,"subscriptionJson"],[1,3042,166,35,"keys"],[1,3048,166,41,"p256dh"],[1,3055,167,10,"auth"],[1,3060,167,16,"subscriptionJson"],[1,3062,167,33,"keys"],[1,3068,167,39,"auth"],[1,3079,172,18,"ok"],[1,3082,173,6],[1,3088,173,12],[1,3092,173,16,"Error"],[1,3098,173,22],[1,3143,180,4],[1,3156,177,10,"AsyncStorage"],[1,3158,177,22,"default"],[1,3166,177,23,"setItem"],[1,3174,177,31],[1,3196,177,54],[1,3204,179,4,"console"],[1,3212,179,12,"log"],[1,3216,179,16],[1,3275,180,11],[1,3276,182,2],[1,3277,182,4],[1,3283,182,11,"error"],[1,3286,184,4],[1,3293,183,4,"console"],[1,3301,183,12,"error"],[1,3307,183,18],[1,3338,183,50,"error"],[1,3342,184,11],[1,3343,185,2],[1,3344,186,0],[1,3345,225,7,"async"],[1,3360,225,22,"isSubscribedToWebPush"],[1,3364,226,2],[1,3369,226,33],[1,3387,226,52,"navigator"],[1,3398,227,4],[1,3405,227,11],[1,3407,230,2],[1,3411,231,4],[1,3417,231,10,"registration"],[1,3425,231,31,"navigator"],[1,3435,231,41,"serviceWorker"],[1,3449,231,55,"ready"],[1,3455,233,4],[1,3462,233,28],[1,3475,232,31,"registration"],[1,3477,232,44,"pushManager"],[1,3489,232,56,"getSubscription"],[1,3506,234,2],[1,3507,234,4],[1,3513,234,11,"error"],[1,3516,235,4],[1,3523,235,11],[1,3524,236,2],[1,3525,237,0],[1,3526,253,1],[1,3529]],"functionMap":{"names":["<global>","getApiBase","urlBase64ToUint8Array","isWebPushSupported","getNotificationPermission","registerServiceWorker","requestNotificationPermission","getVapidPublicKey","subscribeToWebPush","unsubscribeFromWebPush","isSubscribedToWebPush","initWebPushIfPermitted"],"mappings":"AAA;mBCU;CDW;AEK;CFa;OGK;CHQ;OIK;CJG;OKK;CLiB;OMK;CNQ;OOK;CPc;OQK;CRkE;OSK;CT6B;OUK;CVY;OWK;CXW"},"hasCjsExports":false},"type":"js/module"}]}