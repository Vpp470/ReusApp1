{"dependencies":[{"name":"react-native-web/dist/exports/Platform","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"dV3bI3NOD8bfMzaIniMaFGy/nn8=","exportNames":["*"],"imports":1}},{"name":"@react-native-async-storage/async-storage","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":7,"column":0,"index":174},"end":{"line":7,"column":69,"index":243}}],"key":"0kSRlooyBOaYM9tlTtK91nq+uds=","exportNames":["*"],"imports":1}},{"name":"expo-constants","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":8,"column":0,"index":244},"end":{"line":8,"column":39,"index":283}}],"key":"pPv5KzfRT0rL6NCr7G9k0o4d1W8=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function(g,r,_i,a,m,_e,d){\"use strict\";function e(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(_e,'__esModule',{value:!0}),_e.isWebPushSupported=s,_e.getNotificationPermission=c,_e.registerServiceWorker=u,_e.requestNotificationPermission=b,_e.getVapidPublicKey=l,_e.subscribeToWebPush=h,_e.unsubscribeFromWebPush=async function(e){try{const i=await navigator.serviceWorker.ready,n=await i.pushManager.getSubscription();n&&await n.unsubscribe();const s=o();return await fetch(`${s}/web-push/unsubscribe`,{method:'DELETE',headers:{Authorization:e}}),await t.default.removeItem('web_push_subscribed'),console.log('[WebPush] Dessubscrit correctament'),!0}catch(e){return console.error('[WebPush] Error dessubscrivint:',e),!1}},_e.isSubscribedToWebPush=p,_e.initWebPushIfPermitted=async function(e){if(!s())return;if('granted'===c()){await p()||(console.log('[WebPush] Re-subscrivint usuari amb perm\\xeds existent...'),await h(e))}},r(d[0]);var t=e(r(d[1])),i=e(r(d[2]));const o=()=>{const e=i.default.expoConfig?.extra?.EXPO_PUBLIC_BACKEND_URL||process.env.EXPO_PUBLIC_BACKEND_URL;return e?`${e}/api`:'/api'};function n(e){const t=(e+'='.repeat((4-e.length%4)%4)).replace(/-/g,'+').replace(/_/g,'/'),i=window.atob(t),o=new Uint8Array(i.length);for(let e=0;e<i.length;++e)o[e]=i.charCodeAt(e);return o}function s(){return'serviceWorker'in navigator&&'PushManager'in window&&'Notification'in window}function c(){return'Notification'in window?Notification.permission:null}async function u(){if(!('serviceWorker'in navigator))return console.log('[WebPush] Service Worker no suportat'),null;try{const e=await navigator.serviceWorker.register('/sw.js',{scope:'/'});return console.log('[WebPush] Service Worker registrat:',e.scope),e}catch(e){return console.error('[WebPush] Error registrant Service Worker:',e),null}}async function b(){if(!('Notification'in window))return'denied';const e=await Notification.requestPermission();return console.log('[WebPush] Perm\\xeds de notificacions:',e),e}async function l(){try{const e=o();console.log('[WebPush] Obtenint clau VAPID de:',`${e}/web-push/vapid-public-key`);const t=await fetch(`${e}/web-push/vapid-public-key`);if(!t.ok)throw new Error('No s\\'ha pogut obtenir la clau VAPID');return(await t.json()).vapidPublicKey}catch(e){return console.error('[WebPush] Error obtenint clau VAPID:',e),null}}async function h(e){if(!s())return console.log('[WebPush] Web Push no suportat'),!1;try{const i=await u();if(!i)throw new Error('No s\\'ha pogut registrar el Service Worker');if('granted'!==await b())return console.log('[WebPush] Perm\\xeds de notificacions no concedit'),!1;const s=await l();if(!s)throw new Error('No s\\'ha pogut obtenir la clau VAPID');const c=await i.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:n(s)});console.log('[WebPush] Subscripci\\xf3 creada:',c.endpoint);const h=c.toJSON(),p=o();if(!(await fetch(`${p}/web-push/subscribe`,{method:'POST',headers:{'Content-Type':'application/json',Authorization:e},body:JSON.stringify({endpoint:c.endpoint,keys:{p256dh:h.keys?.p256dh,auth:h.keys?.auth}})})).ok)throw new Error('Error guardant subscripci\\xf3 al servidor');return await t.default.setItem('web_push_subscribed','true'),console.log('[WebPush] \\u2705 Subscripci\\xf3 completada amb \\xe8xit'),!0}catch(e){return console.error('[WebPush] Error subscrivint:',e),!1}}async function p(){if(!('serviceWorker'in navigator))return!1;try{const e=await navigator.serviceWorker.ready;return null!==await e.pushManager.getSubscription()}catch(e){return!1}}});","lineCount":1,"map":[[1,144,45,0,"_e"],[1,147,45,0,"isWebPushSupported"],[1,168,58,0,"_e"],[1,171,58,0,"getNotificationPermission"],[1,199,66,0,"_e"],[1,202,66,0,"registerServiceWorker"],[1,226,88,0,"_e"],[1,229,88,0,"requestNotificationPermission"],[1,261,101,0,"_e"],[1,264,101,0,"getVapidPublicKey"],[1,284,120,0,"_e"],[1,287,120,0,"subscribeToWebPush"],[1,308,191,0,"_e"],[1,311,191,0,"unsubscribeFromWebPush"],[1,334,191,7,"async"],[1,349,191,45,"authToken"],[1,352,194,2],[1,356,195,4],[1,362,195,10,"registration"],[1,370,195,31,"navigator"],[1,380,195,41,"serviceWorker"],[1,394,195,55,"ready"],[1,400,196,10,"subscription"],[1,408,196,31,"registration"],[1,410,196,44,"pushManager"],[1,422,196,56,"getSubscription"],[1,440,198,8,"subscription"],[1,449,199,12,"subscription"],[1,451,199,25,"unsubscribe"],[1,465,203,4],[1,471,203,10,"apiBase"],[1,473,203,20,"getApiBase"],[1,477,214,4],[1,490,204,10,"fetch"],[1,496,204,16],[1,499,204,19,"apiBase"],[1,524,204,51],[1,525,205,6,"method"],[1,532,205,14],[1,541,206,6,"headers"],[1,549,206,15],[1,550,207,8,"Authorization"],[1,564,207,25,"authToken"],[1,575,211,10,"AsyncStorage"],[1,577,211,22,"default"],[1,585,211,23,"removeItem"],[1,596,211,34],[1,619,213,4,"console"],[1,627,213,12,"log"],[1,631,213,16],[1,670,214,11],[1,671,216,2],[1,672,216,4],[1,678,216,11,"error"],[1,681,218,4],[1,688,217,4,"console"],[1,696,217,12,"error"],[1,702,217,18],[1,736,217,53,"error"],[1,740,218,11],[1,741,219,2],[1,742,220,0],[1,744,225,0,"_e"],[1,747,225,0,"isSubscribedToWebPush"],[1,771,242,0,"_e"],[1,774,242,0,"initWebPushIfPermitted"],[1,797,242,7,"async"],[1,812,242,45,"authToken"],[1,815,243,2],[1,819,243,7,"isWebPushSupported"],[1,823,243,29],[1,830,246,2],[1,833,246,21],[1,845,245,21,"getNotificationPermission"],[1,849,246,32],[1,856,247,31,"isSubscribedToWebPush"],[1,862,249,6,"console"],[1,870,249,14,"log"],[1,874,249,18],[1,941,250,12,"subscribeToWebPush"],[1,943,250,31,"authToken"],[1,946,252,2],[1,947,253,0],[1,949,253,1,"r"],[1,951,253,1,"d"],[1,953,253,1],[1,957,7,0],[1,961,7,0,"AsyncStorage"],[1,963,7,0,"_interopDefault"],[1,965,7,0,"r"],[1,967,7,0,"d"],[1,969,7,0],[1,974,8,0,"Constants"],[1,976,8,0,"_interopDefault"],[1,978,8,0,"r"],[1,980,8,0,"d"],[1,982,8,0],[1,987,11,0],[1,993,11,6,"getApiBase"],[1,995,11,19,"getApiBase"],[1,1000,13,2],[1,1006,13,8,"envUrl"],[1,1008,13,17,"Constants"],[1,1010,13,26,"default"],[1,1018,13,27,"expoConfig"],[1,1030,13,39,"extra"],[1,1037,13,46,"EXPO_PUBLIC_BACKEND_URL"],[1,1062,14,17,"process"],[1,1070,14,25,"env"],[1,1074,14,29,"EXPO_PUBLIC_BACKEND_URL"],[1,1098,16,2],[1,1105,16,6,"envUrl"],[1,1107,17,11],[1,1110,17,14,"envUrl"],[1,1118,21,9],[1,1126,27,0],[1,1135,27,9,"urlBase64ToUint8Array"],[1,1137,27,31,"base64String"],[1,1140,28,2],[1,1146,29,8,"base64"],[1,1149,29,18,"base64String"],[1,1151,28,18],[1,1155,28,22,"repeat"],[1,1163,28,30],[1,1165,28,34,"base64String"],[1,1167,28,47,"length"],[1,1174,28,56],[1,1177,28,61],[1,1181,30,5,"replace"],[1,1189,30,13],[1,1194,30,19],[1,1199,31,5,"replace"],[1,1207,31,13],[1,1212,31,19],[1,1217,33,8,"rawData"],[1,1219,33,18,"window"],[1,1226,33,25,"atob"],[1,1231,33,30,"base64"],[1,1234,34,8,"outputArray"],[1,1236,34,22],[1,1240,34,26,"Uint8Array"],[1,1251,34,37,"rawData"],[1,1253,34,45,"length"],[1,1261,36,2],[1,1265,36,7],[1,1269,36,11,"i"],[1,1271,36,15],[1,1273,36,18,"i"],[1,1275,36,22,"rawData"],[1,1277,36,30,"length"],[1,1286,36,40,"i"],[1,1288,37,4,"outputArray"],[1,1290,37,16,"i"],[1,1293,37,21,"rawData"],[1,1295,37,29,"charCodeAt"],[1,1306,37,40,"i"],[1,1309,39,2],[1,1316,39,9,"outputArray"],[1,1317,40,0],[1,1318,45,7],[1,1327,45,16,"isWebPushSupported"],[1,1331,48,2],[1,1337,49,4],[1,1355,49,23,"navigator"],[1,1366,50,4],[1,1382,50,21,"window"],[1,1390,51,4],[1,1407,51,22,"window"],[1,1413,53,0],[1,1414,58,7],[1,1423,58,16,"getNotificationPermission"],[1,1427,59,2],[1,1433,59,33],[1,1450,59,51,"window"],[1,1457,60,9,"Notification"],[1,1470,60,22,"permission"],[1,1481,59,67],[1,1485,61,0],[1,1486,66,7,"async"],[1,1501,66,22,"registerServiceWorker"],[1,1505,67,2],[1,1510,67,33],[1,1528,67,52,"navigator"],[1,1539,69,4],[1,1546,68,4,"console"],[1,1554,68,12,"log"],[1,1558,68,16],[1,1598,69,11],[1,1603,72,2],[1,1607,73,4],[1,1613,73,10,"registration"],[1,1621,73,31,"navigator"],[1,1631,73,41,"serviceWorker"],[1,1645,73,55,"register"],[1,1654,73,64],[1,1663,73,74],[1,1664,74,6,"scope"],[1,1670,74,13],[1,1676,78,4],[1,1683,77,4,"console"],[1,1691,77,12,"log"],[1,1695,77,16],[1,1733,77,55,"registration"],[1,1735,77,68,"scope"],[1,1742,78,11,"registration"],[1,1743,79,2],[1,1744,79,4],[1,1750,79,11,"error"],[1,1753,81,4],[1,1760,80,4,"console"],[1,1768,80,12,"error"],[1,1774,80,18],[1,1819,80,64,"error"],[1,1822,81,11],[1,1826,82,2],[1,1827,83,0],[1,1828,88,7,"async"],[1,1843,88,22,"requestNotificationPermission"],[1,1847,89,2],[1,1852,89,33],[1,1869,89,51,"window"],[1,1877,90,4],[1,1883,90,11],[1,1892,93,2],[1,1898,93,8,"permission"],[1,1906,93,27,"Notification"],[1,1919,93,40,"requestPermission"],[1,1939,95,2],[1,1946,94,2,"console"],[1,1954,94,10,"log"],[1,1958,94,14],[1,1998,94,52,"permission"],[1,2001,95,9,"permission"],[1,2002,96,0],[1,2003,101,7,"async"],[1,2018,101,22,"getVapidPublicKey"],[1,2022,102,2],[1,2026,103,4],[1,2032,103,10,"apiBase"],[1,2034,103,20,"getApiBase"],[1,2038,104,4,"console"],[1,2046,104,12,"log"],[1,2050,104,16],[1,2086,104,53],[1,2089,104,56,"apiBase"],[1,2120,105,4],[1,2126,105,10,"response"],[1,2134,105,27,"fetch"],[1,2140,105,33],[1,2143,105,36,"apiBase"],[1,2174,106,4],[1,2178,106,9,"response"],[1,2180,106,18,"ok"],[1,2183,107,6],[1,2189,107,12],[1,2193,107,16,"Error"],[1,2199,107,22],[1,2239,110,4],[1,2252,109,23,"response"],[1,2254,109,32,"json"],[1,2262,110,16,"vapidPublicKey"],[1,2276,111,2],[1,2277,111,4],[1,2283,111,11,"error"],[1,2286,113,4],[1,2293,112,4,"console"],[1,2301,112,12,"error"],[1,2307,112,18],[1,2346,112,58,"error"],[1,2349,113,11],[1,2353,114,2],[1,2354,115,0],[1,2355,120,7,"async"],[1,2370,120,22,"subscribeToWebPush"],[1,2372,120,41,"authToken"],[1,2375,121,2],[1,2379,121,7,"isWebPushSupported"],[1,2383,123,4],[1,2390,122,4,"console"],[1,2398,122,12,"log"],[1,2402,122,16],[1,2437,123,11],[1,2439,126,2],[1,2443,128,4],[1,2449,128,10,"registration"],[1,2457,128,31,"registerServiceWorker"],[1,2461,129,4],[1,2465,129,9,"registration"],[1,2467,130,6],[1,2473,130,12],[1,2477,130,16,"Error"],[1,2483,130,22],[1,2529,135,4],[1,2532,135,23],[1,2550,134,29,"requestNotificationPermission"],[1,2554,137,6],[1,2561,136,6,"console"],[1,2569,136,14,"log"],[1,2573,136,18],[1,2626,137,13],[1,2628,141,4],[1,2634,141,10,"vapidPublicKey"],[1,2642,141,33,"getVapidPublicKey"],[1,2646,142,4],[1,2650,142,9,"vapidPublicKey"],[1,2652,143,6],[1,2658,143,12],[1,2662,143,16,"Error"],[1,2668,143,22],[1,2708,147,4],[1,2714,147,10,"subscription"],[1,2722,147,31,"registration"],[1,2724,147,44,"pushManager"],[1,2736,147,56,"subscribe"],[1,2746,147,66],[1,2747,148,6,"userVisibleOnly"],[1,2764,148,23],[1,2766,149,6,"applicationServerKey"],[1,2787,149,28,"urlBase64ToUint8Array"],[1,2789,149,50,"vapidPublicKey"],[1,2794,152,4,"console"],[1,2802,152,12,"log"],[1,2806,152,16],[1,2841,152,49,"subscription"],[1,2843,152,62,"endpoint"],[1,2853,155,4],[1,2859,155,10,"subscriptionJson"],[1,2861,155,29,"subscription"],[1,2863,155,42,"toJSON"],[1,2872,156,10,"apiBase"],[1,2874,156,20,"getApiBase"],[1,2878,172,4],[1,2889,157,27,"fetch"],[1,2895,157,33],[1,2898,157,36,"apiBase"],[1,2921,157,66],[1,2922,158,6,"method"],[1,2929,158,14],[1,2936,159,6,"headers"],[1,2944,159,15],[1,2945,160,8],[1,2960,160,24],[1,2979,161,8,"Authorization"],[1,2993,161,25,"authToken"],[1,2996,163,6,"body"],[1,3001,163,12,"JSON"],[1,3006,163,17,"stringify"],[1,3016,163,27],[1,3017,164,8,"endpoint"],[1,3026,164,18,"subscription"],[1,3028,164,31,"endpoint"],[1,3037,165,8,"keys"],[1,3042,165,14],[1,3043,166,10,"p256dh"],[1,3050,166,18,"subscriptionJson"],[1,3052,166,35,"keys"],[1,3058,166,41,"p256dh"],[1,3065,167,10,"auth"],[1,3070,167,16,"subscriptionJson"],[1,3072,167,33,"keys"],[1,3078,167,39,"auth"],[1,3089,172,18,"ok"],[1,3092,173,6],[1,3098,173,12],[1,3102,173,16,"Error"],[1,3108,173,22],[1,3153,180,4],[1,3166,177,10,"AsyncStorage"],[1,3168,177,22,"default"],[1,3176,177,23,"setItem"],[1,3184,177,31],[1,3206,177,54],[1,3214,179,4,"console"],[1,3222,179,12,"log"],[1,3226,179,16],[1,3285,180,11],[1,3286,182,2],[1,3287,182,4],[1,3293,182,11,"error"],[1,3296,184,4],[1,3303,183,4,"console"],[1,3311,183,12,"error"],[1,3317,183,18],[1,3348,183,50,"error"],[1,3352,184,11],[1,3353,185,2],[1,3354,186,0],[1,3355,225,7,"async"],[1,3370,225,22,"isSubscribedToWebPush"],[1,3374,226,2],[1,3379,226,33],[1,3397,226,52,"navigator"],[1,3408,227,4],[1,3415,227,11],[1,3417,230,2],[1,3421,231,4],[1,3427,231,10,"registration"],[1,3435,231,31,"navigator"],[1,3445,231,41,"serviceWorker"],[1,3459,231,55,"ready"],[1,3465,233,4],[1,3472,233,28],[1,3485,232,31,"registration"],[1,3487,232,44,"pushManager"],[1,3499,232,56,"getSubscription"],[1,3516,234,2],[1,3517,234,4],[1,3523,234,11,"error"],[1,3526,235,4],[1,3533,235,11],[1,3534,236,2],[1,3535,237,0],[1,3536,253,1],[1,3539]],"functionMap":{"names":["<global>","getApiBase","urlBase64ToUint8Array","isWebPushSupported","getNotificationPermission","registerServiceWorker","requestNotificationPermission","getVapidPublicKey","subscribeToWebPush","unsubscribeFromWebPush","isSubscribedToWebPush","initWebPushIfPermitted"],"mappings":"AAA;mBCU;CDW;AEK;CFa;OGK;CHQ;OIK;CJG;OKK;CLiB;OMK;CNQ;OOK;CPc;OQK;CRkE;OSK;CT6B;OUK;CVY;OWK;CXW"},"hasCjsExports":false},"type":"js/module"}]}